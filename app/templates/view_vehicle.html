{% extends "base.html" %}

{% block title %}{{ vehicle.year }} {{ vehicle.make }} {{ vehicle.model }} - Premium Auto Showroom{% endblock %}

{% block content %}
<div class="container py-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('main.index') }}">Home</a></li>
            <li class="breadcrumb-item"><a href="{{ url_for('main.vehicles') }}">Vehicles</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ vehicle.make }} {{ vehicle.model }}</li>
        </ol>
    </nav>

    <div class="row">
        <!-- Vehicle Images -->
        <div class="col-lg-8">
            <div class="card mb-4">
                <div class="card-body p-0">
                    {% if vehicle.image_filename %}
                    <img src="{{ url_for('static', filename='uploads/' + vehicle.image_filename) }}"
                        class="img-fluid rounded-top" alt="{{ vehicle.make }} {{ vehicle.model }}">
                    {% else %}
                    <img src="https://via.placeholder.com/800x600?text=No+Image+Available" class="img-fluid rounded-top"
                        alt="No image available">
                    {% endif %}
                </div>
            </div>

            <!-- Vehicle Details -->
            <div class="card mb-4">
                <div class="card-body">
                    <h3 class="card-title">Vehicle Details</h3>
                    <div class="row">
                        <div class="col-md-6">
                            <table class="table table-striped">
                                <tr>
                                    <th>Make:</th>
                                    <td>{{ vehicle.make }}</td>
                                </tr>
                                <tr>
                                    <th>Model:</th>
                                    <td>{{ vehicle.model }}</td>
                                </tr>
                                <tr>
                                    <th>Year:</th>
                                    <td>{{ vehicle.year }}</td>
                                </tr>
                                <tr>
                                    <th>Color:</th>
                                    <td>{{ vehicle.color or 'N/A' }}</td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <table class="table table-striped">
                                <tr>
                                    <th>Fuel Type:</th>
                                    <td>{{ vehicle.fuel_type or 'N/A' }}</td>
                                </tr>
                                <tr>
                                    <th>Transmission:</th>
                                    <td>{{ vehicle.transmission or 'N/A' }}</td>
                                </tr>
                                <tr>
                                    <th>Mileage:</th>
                                    <td>{{ "{:,}".format(vehicle.mileage) if vehicle.mileage else 'N/A' }} miles</td>
                                </tr>
                                <tr>
                                    <th>Status:</th>
                                    <td>
                                        <span
                                            class="badge bg-{% if vehicle.is_available %}success{% else %}danger{% endif %}">
                                            {{ 'Available' if vehicle.is_available else 'Sold' }}
                                        </span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>

                    {% if vehicle.description %}
                    <div class="mt-4">
                        <h5>Description</h5>
                        <p class="card-text">{{ vehicle.description }}</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Price and Inquiry -->
        <div class="col-lg-4">
            <div class="card shadow-lg border-0 sticky-top" style="top: 20px;">
                <div class="card-body text-center">
                    <h2 class="text-primary">${{ "{:,.2f}".format(vehicle.price) }}</h2>
                    <p class="text-muted">Price</p>

                    <hr>

                    {% if vehicle.is_available %}
                    <div class="mb-4">
                        <h5>Interested in this vehicle?</h5>
                        <p class="text-muted">Send us an inquiry and we'll get back to you within 24 hours.</p>
                    </div>

                    <!-- Inquiry Form -->
                    <form method="POST" action="{{ url_for('main.vehicle_inquiry', id=vehicle.id) }}">
                        {{ form.hidden_tag() }}

                        <div class="mb-3">
                            {{ form.name.label(class="form-label") }}
                            {{ form.name(class="form-control", placeholder="Your full name") }}
                            {% if form.name.errors %}
                            {% for error in form.name.errors %}
                            <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                            {% endif %}
                        </div>

                        <div class="mb-3">
                            {{ form.email.label(class="form-label") }}
                            {{ form.email(class="form-control", placeholder="Your email address") }}
                            {% if form.email.errors %}
                            {% for error in form.email.errors %}
                            <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                            {% endif %}
                        </div>

                        <div class="mb-3">
                            {{ form.phone.label(class="form-label") }}
                            {{ form.phone(class="form-control", placeholder="Your phone number") }}
                        </div>

                        <div class="mb-3">
                            {{ form.message.label(class="form-label") }}
                            {{ form.message(class="form-control", rows="4", placeholder="Tell us about your interest in
                            this vehicle...") }}
                            {% if form.message.errors %}
                            {% for error in form.message.errors %}
                            <span class="text-danger">{{ error }}</span>
                            {% endfor %}
                            {% endif %}
                        </div>

                        {{ form.submit(class="btn btn-primary btn-lg w-100") }}
                    </form>
                    {% else %}
                    <div class="alert alert-danger">
                        <h5><i class="bi bi-exclamation-triangle"></i> Vehicle Sold</h5>
                        <p class="mb-0">This vehicle is no longer available. Please browse our other vehicles.</p>
                    </div>
                    <a href="{{ url_for('main.vehicles') }}" class="btn btn-outline-primary w-100">
                        Browse Available Vehicles
                    </a>
                    {% endif %}

                    <hr class="my-4">

                    <div class="text-center">
                        <h6>Need immediate assistance?</h6>
                        <p class="mb-2">
                            <i class="bi bi-telephone"></i> Call: (555) 123-4567
                        </p>
                        <p class="mb-0">
                            <i class="bi bi-envelope"></i> Email: sales@premiumauto.com
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}